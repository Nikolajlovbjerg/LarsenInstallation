@using Core
@using System.Globalization

@if (Project == null)
{
    <p class="error-message">Projektet blev ikke fundet!</p>
}
else
{
    <div class="project-detail-content">
        <header class="project-header">
            <h2>@Project.Name</h2>
            <p class="created-date">Oprettet: @Project.DateCreated.ToShortDateString()</p>
        </header>

        
        <section class="overview-section">
            <h3>Omkostninger</h3>
            
            <div class="info-grid">
                
                <div class="info-card primary">
                    <p class="label">Total pris for kunden:</p>
                    <p class="value">@(Project.TotalCostCustomer.ToString("C", new CultureInfo("da-DK")))</p>
                </div>
                
                <div class="info-card secondary">
                    <p class="label">Virksomhedens omkostninger:</p>
                    <p class="value">@(Project.TotalCostCompany.ToString("C", new CultureInfo("da-DK")))</p>
                </div>
                
                <div class="info-card success">
                    <p class="label">Overskud:</p>
                    <p class="value">@((Project.TotalCostCustomer - Project.TotalCostCompany).ToString("C", new CultureInfo("da-DK")))</p>
                </div>
            </div>
        </section>

        <hr class="divider" />

        @foreach (var house in Project.Houses)
        {
            <section class="house-section">
                <h3>Hus @house.Name</h3>
                
                <div class="info-grid compact">
                    <div class="info-card">
                        <p class="label">Pris kunde:</p>
                        <p class="value">@(house.CostCustomer.ToString("C", new CultureInfo("da-DK")))</p>
                    </div>
                    <div class="info-card">
                        <p class="label">Omkostninger:</p>
                        <p class="value">@(house.CostCompany.ToString("C", new CultureInfo("da-DK")))</p>
                    </div>
                    <div class="info-card success">
                        <p class="label">Overskud:</p>
                        <p class="value">@((house.CostCustomer - house.CostCompany).ToString("C", new CultureInfo("da-DK")))</p>
                    </div>
                    <div class="info-card info">
                        <p class="label">Mandetimer brugt:</p>
                        <p class="value">@house.Hours timer</p>
                    </div>
                </div>

                <div class="details-list-group">
                    <div>
                        <h4>Installationer</h4>
                        <ul class="clean-list"> 
                            @foreach (var inst in house.InstallationCosts)
                            {
                                <li>@inst.Key: <span>@inst.Value.ToString("C", new CultureInfo("da-DK"))</span></li>
                            }
                        </ul>
                    </div>
                    <div>
                        <h4>Materialer</h4>
                        <ul class="clean-list">
                            @foreach (var mat in house.MaterialsUsed)
                            {
                                <li>@mat.Key: <span>@mat.Value stk</span></li>
                            }
                        </ul>
                    </div>
                </div>
            </section>
        }

        <hr class="divider" />

        <section class="time-usage-section">
            <h3>Tidsforbrug for projekt</h3>
            <div class="time-entries-list">
                <h4>Detaljeret Tidslog</h4>
                <ul class="clean-list time-log-list">
                    @foreach (var entry in Project.TimeEntries)
                    {
                        <li>@entry.Date.ToShortDateString(): <span>@entry.Hours timer</span></li>
                    }
                </ul>
            </div>
        </section>
    </div>
}

@code {
    [Parameter] public Project? Project { get; set; }
}